{% extends "base.html" %}

{% block title %}{{ category | capitalize }} Mülakat Sorusu #{{ question_num }} - Interviewly{% endblock %}

{% block content %}
<div class="question-page" data-question-num="{{ question_num }}">
    <div class="container">
        <!-- Progress Header -->
        <div class="progress-header" data-aos="fade-down">
            <div class="progress-info">
                <h1 class="page-title">
                    <i class="fas fa-question-circle"></i>
                    {{ category | capitalize }} Mülakatı
                </h1>
                <div class="progress-details">
                    <span class="progress-text">Soru {{ question_num }} / {{ total_questions }}</span>
                    <div class="progress-bar">
                        <div class="progress-fill" style="width: {{ (question_num / total_questions) * 100 }}%"></div>
                    </div>
                </div>
            </div>
            <div class="question-stats">
                <div class="stat-item">
                    <div class="stat-icon">
                        <i class="fas fa-clock"></i>
                    </div>
                    <div class="stat-info">
                        <span class="stat-value" id="timer">00:00</span>
                        <span class="stat-label">Geçen Süre</span>
                    </div>
                </div>
                <div class="stat-item">
                    <div class="stat-icon">
                        <i class="fas fa-percentage"></i>
                    </div>
                    <div class="stat-info">
                        <span class="stat-value">{{ ((question_num - 1) / total_questions * 100) | round(1) }}%</span>
                        <span class="stat-label">Tamamlanan</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Question Card -->
        <div class="question-card" data-aos="fade-up">
            <div class="question-header">
                <div class="question-meta">
                    <span class="question-number">Soru #{{ question_num }}</span>
                    <span class="question-category">{{ category | capitalize }}</span>
                </div>
                <div class="question-actions">
                    <button class="action-btn" id="fullscreenBtn" title="Tam ekran">
                        <i class="fas fa-expand"></i>
                    </button>
                    <button class="action-btn" id="copyBtn" title="Soruyu kopyala">
                        <i class="fas fa-copy"></i>
                    </button>
                </div>
            </div>

            <div class="question-content">
                <div class="question-text">
                    {{ question_text | safe }}
                </div>
            </div>

            <!-- Answer Form -->
            <div class="answer-section">
                <form method="POST" action="{{ url_for('interview.interview') }}" class="answer-form" id="answerForm">
                    <div class="form-group">
                        <label for="user_input" class="form-label">
                            <i class="fas fa-edit"></i>
                            Cevabınızı yazın
                        </label>
                        <div class="textarea-wrapper">
                            <textarea id="user_input" name="user_input" class="answer-textarea"
                                placeholder="Cevabınızı buraya yazın..." required rows="6" maxlength="2000"></textarea>
                            <div class="textarea-footer">
                                <div class="char-counter" id="charCounter">0/2000</div>
                                <div class="word-counter" id="wordCounter">0 kelime</div>
                            </div>
                        </div>
                    </div>

                    <div class="form-actions">
                        <button type="button" class="btn btn-secondary" id="saveDraftBtn">
                            <i class="fas fa-save"></i>
                            Taslak Kaydet
                        </button>
                        <button type="submit" class="btn btn-primary" id="submitBtn">
                            <i class="fas fa-paper-plane"></i>
                            Cevabı Gönder
                        </button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Navigation -->
        <div class="navigation-section" data-aos="fade-up" data-aos-delay="200">
            <div class="nav-buttons">
                {% if question_num > 1 %}
                <a href="{{ url_for('interview.interview_question_route', category=category, question_num=question_num - 1) }}"
                    class="btn btn-outline">
                    <i class="fas fa-arrow-left"></i>
                    Önceki Soru
                </a>
                {% endif %}

                <div class="nav-center">
                    <a href="{{ url_for('interview.interview') }}" class="btn btn-secondary">
                        <i class="fas fa-comments"></i>
                        Sohbet Odasına Dön
                    </a>
                </div>

                {% if question_num < total_questions %} <a
                    href="{{ url_for('interview.interview_question_route', category=category, question_num=question_num + 1) }}"
                    class="btn btn-outline">
                    Sonraki Soru
                    <i class="fas fa-arrow-right"></i>
                    </a>
                    {% else %}
                    <a href="{{ url_for('interview.interview') }}" class="btn btn-success">
                        <i class="fas fa-check-circle"></i>
                        Mülakatı Tamamla
                    </a>
                    {% endif %}
            </div>

            <div class="quick-actions">
                <a href="{{ url_for('interview.create_interview') }}" class="quick-action-btn">
                    <i class="fas fa-plus"></i>
                    Yeni Mülakat
                </a>
                <a href="{{ url_for('interview.my_interviews') }}" class="quick-action-btn">
                    <i class="fas fa-history"></i>
                    Geçmiş Mülakatlar
                </a>
                <a href="{{ url_for('main.index') }}" class="quick-action-btn">
                    <i class="fas fa-home"></i>
                    Ana Sayfa
                </a>
            </div>
        </div>
    </div>
</div>

<!-- Save Draft Modal -->
<div class="modal" id="saveModal">
    <div class="modal-content">
        <div class="modal-header">
            <h3><i class="fas fa-save"></i> Taslak Kaydet</h3>
        </div>
        <div class="modal-body">
            <p>Cevabınızı taslak olarak kaydetmek istediğinizden emin misiniz?</p>
        </div>
        <div class="modal-footer">
            <button class="btn btn-secondary" id="cancelSaveBtn">İptal</button>
            <button class="btn btn-primary" id="confirmSaveBtn">Kaydet</button>
        </div>
    </div>
</div>
{% endblock %}
